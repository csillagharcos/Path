{% extends "base.html" %}
{% load i18n l10n %}
{% block header %}<div id="content_home">{% trans "R1. indicators for rehabilitation hospitals and departments" %}</div>
    <div id="content_helper">
        <table>
            <tr>
                <td><a href="{% url report_forms %}"><img src="{{ STATIC_URL }}/images/white.appbar.arrow.left.png" title="{% trans "Report Forms" %}" /></a></td>
                <td><a href="{% url r1_display %}"><img src="{{ STATIC_URL }}/images/white.appbar.clipboard.edit.png" title="{% trans "Form" %}" /></a></td>
                <td><a href="{% url r1_stat %}"><img src="{{ STATIC_URL }}/images/white.appbar.graph.bar.png" title="{% trans "Statistics" %}" /></a></td>
                <td><a href="{% url r1_import %}"><img src="{{ STATIC_URL }}/images/white.appbar.paperclip.png" title="{% trans "Import" %}" /></a></td>
                <td><a href="{% url r1_template %}"><img src="{{ STATIC_URL }}/images/white.appbar.page.excel.png" title="{% trans "Template" %}" /></a></td>
                <td><a href="{{ STATIC_URL }}documents/dcs/{{ LANGUAGE_CODE }}/r1a.docx"><img src="{{ STATIC_URL }}/images/white.appbar.page.word.png" title="{% trans "Data collecting sheet" %}" /></a></td>
                <td><a href="{{ STATIC_URL }}documents/drt/{{ LANGUAGE_CODE }}/r1a.xlsx"><img src="{{ STATIC_URL }}/images/white.appbar.page.excel.png" title="{% trans "Data reporting tables" %}" /></a></td>
                <td><a href="{{ STATIC_URL }}documents/sid/{{ LANGUAGE_CODE }}/r1a.docx"><img src="{{ STATIC_URL }}/images/white.appbar.page.word.png" title="{% trans "Short indicator description" %}" /></a></td>
            </tr>
        </table>
    </div>
{% endblock header %}

{% block content %}
    {% if r1acounted < 60 %}
        {% trans "Sorry, you have less than 60 cases for R1/A." %} <br /><br />
    {% else %}
        <table class="los">
            <tr>
                <th colspan="2">{% trans "Functional assessment at admission" %}</th>
            </tr>
            <tr>
                <td>{% trans "Percentage of patients who have documented functional assessment at admission to an inpatient unit for rehabilitation program within 7 days of admission" %}</td>
                <td>{{ r1a1|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of patients who have documented functional assessment at admission to an inpatient unit for rehabilitation program within 2 days of admission" %}</td>
                <td>{{ r1a2|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of patients who have documented functional assessment at admission to an inpatient unit for rehabilitation program within 3 days of admission" %}</td>
                <td>{{ r1a3|floatformat:"2" }}%</td>
            </tr>
        </table>
    {% endif %}
    {% if r1bcounted < 60 %}
        {% trans "Sorry, you have less than 60 cases for R1/B." %} <br /><br />
    {% else %}
        <table class="los">
            <tr>
                <th colspan="2">{% trans "Functional assessment prior to discharge" %}</th>
            </tr>
            <tr>
                <td>{% trans "Percentage of patients who have documented evidence of functional assessment in 3 days prior to discharge" %}</td>
                <td>{{ r1b1|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of patients who have documented evidence of functional assessment in 1 days prior to discharge" %}</td>
                <td>{{ r1b2|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of patients who have documented evidence of functional assessment in 2 days prior to discharge" %}</td>
                <td>{{ r1b3|floatformat:"2" }}%</td>
            </tr>
        </table>
    {% endif %}
    {% if r2counted < 60 %}
        {% trans "Sorry, you have less than 60 cases for R2." %} <br /><br />
    {% else %}
        <table class="los">
            <tr>
                <th colspan="2">{% trans "Unplanned interruption to rehabilitation program" %}</th>
            </tr>
            <tr>
                <td>{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly" %}</td>
                <td>{{ r21|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly because of an acute illness independent from the original disease" %}</td>
                <td>{{ r22|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly on the demand of patient/family" %}</td>
                <td>{{ r23|floatformat:"2" }}%</td>
            </tr>
            <tr>
                <td>{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly because of a complication of the original disease" %}</td>
                <td>{{ r24|floatformat:"2" }}%</td>
            </tr>
        </table>
    {% endif %}
    <div id="graph1" style="margin-top: 20px; height: 700px"></div>
{% endblock content %}

{% block js %}
    <script src="{{ STATIC_URL }}js/jquery.jqplot.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.barRenderer.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.canvasTextRenderer.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.canvasAxisTickRenderer.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.categoryAxisRenderer.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.highlighter.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function(){
            {% localize off %}
                var first = [
                    {% if r1acounted >= 60 %}
                        ['{% trans "Percentage of patients who have documented functional assessment at admission to an inpatient unit for rehabilitation program within 7 days of admission" %}', {{ r1a1 }}],
                        ['{% trans "Percentage of patients who have documented functional assessment at admission to an inpatient unit for rehabilitation program within 2 days of admission" %}', {{ r1a2 }}],
                        ['{% trans "Percentage of patients who have documented functional assessment at admission to an inpatient unit for rehabilitation program within 3 days of admission" %}', {{ r1a3 }}],
                    {% endif %}
                    {% if r1bcounted >= 60 %}
                        ['{% trans "Percentage of patients who have documented evidence of functional assessment in 3 days prior to discharge" %}', {{ r1b1 }}],
                        ['{% trans "Percentage of patients who have documented evidence of functional assessment in 1 days prior to discharge" %}', {{ r1b2 }}],
                        ['{% trans "Percentage of patients who have documented evidence of functional assessment in 2 days prior to discharge" %}', {{ r1b3 }}],
                    {% endif %}
                    {% if r2counted >= 60 %}
                        ['{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly" %}', {{ r21 }}],
                        ['{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly because of an acute illness independent from the original disease" %}', {{ r22 }}],
                        ['{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly on the demand of patient/family" %}', {{ r23 }}],
                        ['{% trans "Percentage of those patients whose rehabilitation program interrupted unexpectedly because of a complication of the original disease" %}', {{ r24 }}]
                    {% endif %}
                ];
            {% endlocalize %}
            $.jqplot('graph1', [first], {
                seriesDefaults: {renderer: $.jqplot.BarRenderer},
                axes: {
                    xaxis:{
                        renderer:$.jqplot.CategoryAxisRenderer,
                        tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
                        tickOptions: {
                            angle: -30,
                            labelPosition: 'end',
                            fontSize: 8
                        }
                    },
                    yaxis:{
                        tickOptions: {
                            formatString: '%.2f'
                        },
                        min: 0,
                        max: 100}
                },
                highlighter: {
                    show: true,
                    tooltipAxes: 'y',
                    formatString: '%.2f%'
                }
            });
        });
    </script>
{% endblock js %}