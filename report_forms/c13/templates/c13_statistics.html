{% extends "base.html" %}
{% load i18n l10n %}
{% block header %}
    <div id="content_home">{% trans "C.13. Needle stick injuries" %}</div>
    <div id="content_helper">
        <table>
            <tr>
                <td><a href="{% url report_forms %}"><img src="{{ STATIC_URL }}/images/white.appbar.arrow.left.png" title="{% trans "Report Forms" %}" /></a></td>
                <td><a href="{% url c13_display %}"><img src="{{ STATIC_URL }}/images/white.appbar.clipboard.edit.png" title="{% trans "Form" %}" /></a></td>
                <td><a href="{% url c13_stat %}"><img src="{{ STATIC_URL }}/images/white.appbar.graph.bar.png" title="{% trans "Statistics" %}" /></a></td>
                <td><img src="{{ STATIC_URL }}/images/gray.appbar.paperclip.png" title="{% trans "Import" %}" /></td>
                <td><a href="{% url c13_template %}"><img src="{{ STATIC_URL }}/images/white.appbar.page.excel.png" title="{% trans "Template" %}" /></a></td>
                <td><a href="{{ STATIC_URL }}documents/dcs/{{ LANGUAGE_CODE }}/c13.docx"><img src="{{ STATIC_URL }}/images/white.appbar.page.word.png" title="{% trans "Data collecting sheet" %}" /></a></td>
                <td><img src="{{ STATIC_URL }}/images/gray.appbar.page.excel.png" title="{% trans "Data reporting tables" %}" /></td>
                <td><a href="{{ STATIC_URL }}documents/sid/{{ LANGUAGE_CODE }}/c13.docx"><img src="{{ STATIC_URL }}/images/white.appbar.page.word.png" title="{% trans "Short indicator description" %}" /></a></td>
            </tr>
        </table>
    </div>
{% endblock header %}

{% block content %}
    <table class="needle">
        <tr>
            <th>{% trans "Job" %}</th>
            <th>{% trans "Number of needle stick injuries to 100 workers (average number)" %}</th>
            <th>{% trans "Number of needle stick injuries to 100 workers (FTE = full time equivalent)" %}</th>
        </tr>
        {% for job in jobs %}
        <tr>
            <td>{{ job.0 }}</td>
            <td>{{ job.1|floatformat:"2" }}</td>
            <td>{{ job.2|floatformat:"2" }}</td>
        </tr>
        {% endfor %}
    </table>
    <div id="avg" style="margin-top: 20px; height: 200px;"></div>
    <div id="fte" style="margin-top: 20px; height: 200px;"></div>
{% endblock content %}

{% block js %}
    <script src="{{ STATIC_URL }}js/jquery.jqplot.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.barRenderer.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.categoryAxisRenderer.min.js"></script>
    <script src="{{ STATIC_URL }}js/plugins/jqplot.pointLabels.min.js"></script>
    <script style="text/javascript">
        $(document).ready(function(){
            $.jqplot('avg', [[{% for job in jobs %}{% localize off %}{{ job.1 }}{% endlocalize %}{% if not forloop.last %},{% endif %}{% endfor %}]], {
                title: "{% trans "Number of needle stick injuries to 100 workers (average number)" %}",
                seriesDefaults:{
                    renderer:$.jqplot.BarRenderer,
                    pointLabels: { show: true }
                },
                axes: {
                    xaxis: {
                        renderer: $.jqplot.CategoryAxisRenderer,
                        ticks: [{% for job in jobs %}"{{ job.0 }}"{% if not forloop.last %},{% endif %}{% endfor %}]
                    },
                    yaxis: {
                        tickOptions: {formatString: '%.2f'}
                    }
                }
            });

            $.jqplot('fte', [[{% for job in jobs %}{% localize off %}{{ job.2 }}{% endlocalize %}{% if not forloop.last %},{% endif %}{% endfor %}]], {
                title: "{% trans "Number of needle stick injuries to 100 workers (FTE = full time equivalent)" %}",
                seriesDefaults:{
                    renderer:$.jqplot.BarRenderer,
                    pointLabels: { show: true }
                },
                axes: {
                    xaxis: {
                        renderer: $.jqplot.CategoryAxisRenderer,
                        ticks: [{% for job in jobs %}"{{ job.0 }}"{% if not forloop.last %},{% endif %}{% endfor %}]
                    },
                    yaxis: {
                        tickOptions: {formatString: '%.2f'}
                    }
                }
            });
        });
    </script>
{% endblock js %}